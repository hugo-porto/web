{{ define "main" }}
<style>
  .project-section {
    padding: 4rem 0;
    position: relative;
    border-bottom: 1px solid rgba(229, 231, 235, 0.8);
  }
  
  .project-section:last-of-type {
    border-bottom: none;
  }
  
  .project-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 3rem;
    align-items: start;
  }
  
  
  .project-images {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }
  
  .project-image {
    width: 100%;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  
  .project-image:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 30px rgba(0,0,0,0.15);
  }
  
  /* Scroll indicator with labels */
  .scroll-indicator {
    position: fixed;
    right: 2rem;
    top: 50%;
    transform: translateY(-50%);
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    z-index: 50;
  }
  
  .scroll-dot-container {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    gap: 0.75rem;
    cursor: pointer;
    transition: all 0.3s;
  }
  
  .scroll-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: rgba(107, 114, 128, 0.3);
    transition: all 0.3s;
    flex-shrink: 0;
  }
  
  .scroll-dot-container.active .scroll-dot {
    background: rgba(107, 114, 128, 1);
    transform: scale(1.3);
  }
  
  .scroll-dot-label {
    color: rgba(107, 114, 128, 0.7);
    font-size: 0.875rem;
    font-weight: 500;
    white-space: nowrap;
    transition: all 0.3s;
  }
  
  .scroll-dot-container.active .scroll-dot-label {
    color: rgba(31, 41, 55, 1);
    font-size: 1rem;
    text-decoration: underline;
    font-weight: 600;
  }
  
  @media (max-width: 1024px) {
    .project-container {
      grid-template-columns: 1fr;
    }
    
    .scroll-dot-label {
      display: none;
    }
  }
</style>

<div class="container mx-auto px-4 py-16 max-w-7xl">
  <div class="text-center mb-20">
    <h1 class="text-6xl md:text-7xl font-bold text-gray-800 mb-6 font-poppins">{{ .Title }}</h1>
    <p class="text-2xl text-gray-600">{{ .Description }}</p>
  </div>

  {{ range $index, $page := .Pages }}
    {{ if not $page.IsHome }}
    <section class="project-section" id="project-{{ $index }}" data-project-section data-project-index="{{ $index }}" data-project-title="{{ $page.Title }}" data-nav-label="{{ if $page.Params.nav_label }}{{ $page.Params.nav_label }}{{ else }}{{ $page.Title }}{{ end }}">
      <div class="project-container">
        <!-- Content -->
        <div class="project-content">
          <h2 class="text-4xl md:text-5xl font-semibold text-gray-800 mb-4 font-poppins">{{ $page.Title }}</h2>
          
          {{ if $page.Params.description }}
          <p class="text-xl text-gray-600 mb-6 italic">{{ $page.Params.description }}</p>
          {{ end }}

          {{ if $page.Params.tags }}
          <div class="flex flex-wrap gap-2 mb-8">
            {{ range $page.Params.tags }}
            <span class="px-4 py-2 bg-gray-200 text-gray-700 rounded-full text-sm font-medium">{{ . }}</span>
            {{ end }}
          </div>
          {{ end }}

          <div class="prose prose-lg max-w-none text-gray-700 mb-8">
            {{ $page.Content }}
          </div>

          {{ if $page.Params.github }}
          <div class="mt-8">
            <a href="{{ $page.Params.github }}" target="_blank" rel="noopener noreferrer" 
               class="inline-flex items-center px-6 py-3 bg-gray-800 text-white rounded-lg hover:bg-gray-700 transition text-lg">
              <i class='bx bxl-github text-2xl mr-2'></i>
              View on GitHub
            </a>
          </div>
          {{ end }}
        </div>

        <!-- Images -->
        <div class="project-images">
          {{ if $page.Params.images }}
            {{ range $imgIndex, $imgName := $page.Params.images }}
              {{ $imgResource := $page.Resources.GetMatch $imgName }}
              {{ if $imgResource }}
                <img src="{{ $imgResource.RelPermalink }}" alt="{{ $page.Title }} visualization {{ add $imgIndex 1 }}" 
                     class="project-image" />
              {{ end }}
            {{ end }}
          {{ end }}
        </div>
      </div>
    </section>
    {{ end }}
  {{ end }}
</div>

<!-- Scroll Navigation Dots -->
<div class="scroll-indicator" id="scroll-indicator"></div>

<script>
  const projectSections = document.querySelectorAll('[data-project-section]');
  const indicator = document.getElementById('scroll-indicator');
  
  // Create navigation dots with labels
  projectSections.forEach((section, index) => {
    const container = document.createElement('div');
    container.className = 'scroll-dot-container';
    
    const label = document.createElement('div');
    label.className = 'scroll-dot-label';
    label.textContent = section.dataset.navLabel;
    
    const dot = document.createElement('div');
    dot.className = 'scroll-dot';
    
    container.appendChild(label);
    container.appendChild(dot);
    
    container.addEventListener('click', () => {
      section.scrollIntoView({ behavior: 'smooth', block: 'start' });
    });
    
    indicator.appendChild(container);
  });
  
  function updateActiveProject() {
    const windowHeight = window.innerHeight;
    const dotContainers = document.querySelectorAll('.scroll-dot-container');
    
    let activeIndex = 0;
    let minDistance = Infinity;
    
    projectSections.forEach((section, sectionIndex) => {
      const rect = section.getBoundingClientRect();
      const sectionTop = rect.top;
      const sectionBottom = rect.bottom;
      const sectionHeight = rect.height;
      
      // Find which section is most centered in the viewport
      const sectionCenter = sectionTop + sectionHeight / 2;
      const viewportCenter = windowHeight / 2;
      const distanceFromCenter = Math.abs(sectionCenter - viewportCenter);
      
      if (distanceFromCenter < minDistance && sectionTop < windowHeight && sectionBottom > 0) {
        minDistance = distanceFromCenter;
        activeIndex = sectionIndex;
      }
    });
    
    // Update active state
    dotContainers.forEach((container, index) => {
      if (index === activeIndex) {
        container.classList.add('active');
      } else {
        container.classList.remove('active');
      }
    });
  }
  
  // Update on scroll
  let ticking = false;
  window.addEventListener('scroll', () => {
    if (!ticking) {
      window.requestAnimationFrame(() => {
        updateActiveProject();
        ticking = false;
      });
      ticking = true;
    }
  });
  
  window.addEventListener('resize', updateActiveProject);
  
  // Initial update
  updateActiveProject();
</script>
{{ end }}

